library(reshape)
install.packages("reshape")
library(reshape)
dat<-melt(dat,id=c("x"))
dat
table(value)
table(dat$value)
barplot(dat$Shellfish)
barplot(dat$value)
tab<-table(dat$value)
barplot(tab)
tab<-table(dat$value,dat$variable)
barplot(tab)
dat.ord<-matrix(dat$value)
matrix(dat$value,nrow=3)
dat.ord<-matrix(dat$value,nrow=3,by.row=T)
dat.ord<-matrix(dat$value,nrow=3,byrow=T)
dat.ord
dat.ord<-matrix(dat$value,byrow=T)
dat.ord
dat.ord<-matrix(dat$value,nrow=2,byrow=T)
dat.ord
str(dat)
dat.ord<-matrix(dat$value,nrow=2,byrow=T)
colnames(dat.ord)=levels(dat$x)
rownames(dat.ord)=levels(dat$variable)
barplot(dat.ord)
legend("topright",inset=c(-0.25,0), legend=rownames(dat.ord))
barplot(dat.ord,ylab="%")
legend("topright",inset=c(-0.25,0), legend=rownames(dat.ord))
par(mar=c(5.1, 4.1, 4.1, 7.1), xpd=TRUE)
barplot(dat.ord,ylab="%")
legend("topright",inset=c(-0.25,0), legend=rownames(dat.ord))
barplot(dat.ord,ylab="%",col=c("grey10","grey80"))
barplot(dat.ord,ylab="%",col=c("grey20","grey80"))
barplot(dat.ord,ylab="%",col=c("grey40","grey80"))
barplot(dat.ord,ylab="%",col=c("blue","grey80"))
barplot(dat.ord,ylab="%",col=c("darkblue","grey80"))
barplot(dat.ord,ylab="%",col=c("darkblue","skyblue"))
legend("topright",inset=c(-0.25,0), legend=rownames(dat.ord),
fill=c("darkblue","skyblue"))
windows(width=4,height=3)
quartz(width=4,height=3)
par(mar=c(5.1, 4.1, 4.1, 7.1), xpd=TRUE)
barplot(dat.ord,ylab="%",col=c("darkblue","skyblue"))
legend("topright",inset=c(-0.25,0), legend=rownames(dat.ord),
fill=c("darkblue","skyblue"))
quartz(width=4,height=3)
par(mar=c(5.1, 4.1, 4.1, 7.1), xpd=TRUE)
barplot(dat.ord,ylab="%",col=c("darkblue","skyblue"))
legend("topright",inset=c(-5,0), legend=rownames(dat.ord),
fill=c("darkblue","skyblue"))
legend("topright",inset=c(-3,0), legend=rownames(dat.ord),
fill=c("darkblue","skyblue"))
legend("topright",inset=c(-1,0), legend=rownames(dat.ord),
fill=c("darkblue","skyblue"))
dat<-data.frame(x = c("Catch","Landed value",
"International trade value"),
Shellfish = c(18,34,33),
Finfish = c(82,66,67))
K<-100
r<-0.2
N<-c(1:100)
G<-r*N*(1-N/K)
plot(G~N)
A<-G+N
plot(A~N)
A
Ninit<-1
time<-100
source('~/.active-rstudio-document', echo=TRUE)
A<-vector()
K<-100
r<-0.2
time<-100
Ninit<-1
A<-vector()
A[1]<-Ninit
i<-1
N<-A[i]
N<-N+r*N*(1-N/K)
A[i+1]<-N
K<-100
r<-0.2
time<-100
Ninit<-1
A<-vector()
A[1]<-Ninit
for(i in 1:length(time)){
N<-A[i]
N<-N+r*N*(1-N/K)
A[i+1]<-N
}
plot(A~time)
K<-100
r<-0.2
time<-100
Ninit<-1
A<-vector()
A[1]<-Ninit
for(i in 1:length(time)){
N<-A[i]
N<-N+r*N*(1-N/K)
A[i+1]<-N
}
rm(list=ls())
K<-100
r<-0.2
time<-100
Ninit<-1
A<-vector()
A[1]<-Ninit
for(i in 1:length(time)){
N<-A[i]
N<-N+r*N*(1-N/K)
A[i+1]<-N
}
K<-100
r<-0.2
time<-1:100
Ninit<-1
A<-vector()
A[1]<-Ninit
for(i in 1:length(time)){
N<-A[i]
N<-N+r*N*(1-N/K)
A[i+1]<-N
}
plot(A~time)
plot(A)
K<-100
r<-0.1
time<-1:100
Ninit<-1
A<-vector()
A[1]<-Ninit
for(i in 1:length(time)){
N<-A[i]
N<-N+r*N*(1-N/K)
A[i+1]<-N
}
plot(A)
a<-0.7
W<-1:100
Ana<-W^a
plot(Ana~W)
a<-0.9
W<-1:100
Ana<-W^a
plot(Ana~W)
a<-0.5
W<-1:100
Ana<-W^a
plot(Ana~W)
install.packages(c("RCurl", "XML"))
library(RCurl)
library(XML)
library(plyr)
h=basicTextGatherer()
curlPerform(url = 'http://sirs.agrocampus-ouest.fr/EcoBase/php/webser/soap-client_3.php',writefunction=h$update)
data<-xmlTreeParse(h$value(),useInternalNodes=TRUE)
liste_mod<-ldply(xmlToList(data),data.frame)
View(liste_mod)
?lm
?setClass
setClass("Person", representation(name = "character", age = "numeric"))
setClass("Employee", representation(boss = "Person"), contains = "Person")
hadley <- new("Person", name = "Hadley", age = 31)
Person
hadley
Hadley
hadley <- new("Person", name = "Hadley")
Hadley
hadley
slot(hadley, "age")
hadley <- new("Person", name = "Hadley", age = 31)
slot(hadley, "age")
getSlots("Person")
getSlots("hadley")
getSlots(hadley)
Slots(hadley)
slots(hadley)
(hadley)
slot(hadley)
hadley <- new("Person", name = "Hadley", age = 31)
slot(hadley,"Hadley")
slot(hadley)
slot(hadley,"name")
slot(hadley,"age")
library(ggplot2)
library(grid)
library(gridExtra)
library(plyr)
library(lme4)
library(visreg)
library(reshape)
library(ggplot2)
library(grid)
library(gridExtra)
library(plyr)
library(lme4)
library(visreg)
library(reshape)
## clean data and merge with journal metric data
rm(list=ls())
setwd("~/GitHub/open-climate-change/")
setwd('/Users/robins64/Documents/git_repos/open-climate-change')
## load data
load("./Data/scopus_OA_climate_clean.Rdata")  ## scopus data filtered by Jimmy - journals with > 200 papers in last 10 years
load('./Data/scopus_glmerfit.Rdata')
## choose filtered data or full data
dat<-scop
dat$Cited.by[which(is.na(dat$Cited.by))]<-0
jour.dat<-dat[,c("Source.title","X2016.CiteScore","X2016.SJR","X2016.SNIP","Journal.Open.Access")]
jour.dat<-jour.dat[-which(duplicated(jour.dat)),]
Jour.Var<-"X2016.SJR"     ## Use this
bins<-quantile(jour.dat[,Jour.Var],na.rm=T)  ##quantile bins
jour.dat$bin<-cut(jour.dat[,Jour.Var],breaks = bins,labels = LETTERS[1:(length(bins)-1)])
jour.dat$bin[which(is.na(jour.dat$bin))]<-"A"
dat$jour.bin<-cut(dat[,Jour.Var],breaks = bins,labels = LETTERS[1:(length(bins)-1)])
dat$jour.bin[which(is.na(dat$jour.bin))]<-"A"
names(dat)
sub.dat<-dat[,c("Source.title","Year","Cited.by","OA","Open.Access","jour.bin")]
mod.dat<-ddply(sub.dat,.(Source.title,Year,Open.Access,OA,jour.bin),summarize,
MeanCite = mean(Cited.by,na.rm=T))
fit5a<-lmer(log10MeanCite ~ jour.bin*OA + (1|Year) + (1 | Source.title),data=mod.dat)
summary(fit5a)
hist(resid(fit5a))
names(dat)
sub.dat<-dat[,c("Source.title","Year","Cited.by","OA","Open.Access","jour.bin")]
mod.dat<-ddply(sub.dat,.(Source.title,Year,Open.Access,OA,jour.bin),summarize,
MeanCite = mean(Cited.by,na.rm=T))
mod.dat$log10MeanCite<-log10(mod.dat$MeanCite+1)
fit5a<-lmer(log10MeanCite ~ jour.bin*OA + (1|Year) + (1 | Source.title),data=mod.dat)
summary(fit5a)
hist(resid(fit5a))
fit5c<-lmer(log10MeanCite ~ jour.bin*OA + (Source.title|Year),data=mod.dat)
AIC(fit5a)
AIC(fit5a)
fit5a<-lmer(log10MeanCite ~ jour.bin*OA + (1|Year) + (1 | Source.title),data=mod.dat)
summary(fit5a)
hist(resid(fit5a))
AIC(fit5a)
fit5c<-lmer(log10MeanCite ~ jour.bin*OA + (1|Year),data=mod.dat)
summary(fit5a)
hist(resid(fit5a))
summary(fit5c)
hist(resid(fit5c))
AIC(fit5c)
fit5d<-lmer(log10MeanCite ~ jour.bin*OA + (1|Source.title),data=mod.dat)
summary(fit5d)
hist(resid(fit5d))
AIC(fit5d)
View(mod.dat)
fit5b<-glmer(MeanCite ~ jour.bin*OA + (1|Year),data=mod.dat,family="poisson")
View(mod.dat)
ggplot(mod.dat) + geom_boxplot(aes(x=Year,y=MeanCite,colour=OA)) + facet_grid(~jour.bin)
View(mod.dat)
ggplot(mod.dat) + geom_boxplot(aes(x=as.factor(Year),y=MeanCite,colour=OA)) + facet_grid(~jour.bin)
ggplot(mod.dat) + geom_boxplot(aes(x=as.factor(Year),y=MeanCite,colour=OA)) + facet_wrap(~jour.bin)
ggplot(mod.dat) + geom_boxplot(aes(x=as.factor(Year),y=MeanCite,colour=OA)) +
facet_wrap(~jour.bin,scales="free")
quartz()
ggplot(mod.dat) + geom_boxplot(aes(x=as.factor(Year),y=MeanCite,colour=OA)) +
facet_wrap(~jour.bin,scales="free")
ggplot(mod.dat) + geom_boxplot(aes(x=jour.bin,y=MeanCite,colour=OA))
ggplot(mod.dat) + geom_boxplot(aes(x=as.factor(Year),y=MeanCite,colour=OA)) +
facet_wrap(~jour.bin,scales="free")
fit5b<-glmer(MeanCite ~ jour.bin*OA + (1|Year),data=mod.dat,family="poisson")
warnings()
summary(mod.dat)
View(mod.dat)
AIC(fit5b)
hist(mod.dat$MeanCite)
?glmer
fit5z<-glmer(MeanCite ~ jour.bin*OA + (1|Year),data=mod.dat,family=Gamma(link("inverse")))
fit5z<-glmer(MeanCite ~ jour.bin*OA + (1|Year),data=mod.dat,family=Gamma)
fit5z<-glmer(MeanCite ~ jour.bin*OA + (1|Year),data=mod.dat,family=gamma)
fit5z<-glmer(MeanCite ~ jour.bin*OA + (1|Year),data=mod.dat,family='gamma')
fit5z<-glmer(MeanCite ~ jour.bin*OA + (1|Year),data=mod.dat,family=Gamma)
fit5z<-glmer((MeanCite+1) ~ jour.bin*OA + (1|Year),data=mod.dat,family=Gamma)
AIC(fit5b)
AIC(fit5z)
fit5z<-glmer((MeanCite+1) ~ jour.bin*OA + (1|Year),data=mod.dat,family=Gamma(link="inverse"))
fit5z<-glmer(MeanCite ~ jour.bin*OA + (1|Year),data=mod.dat,family=Gamma(link="inverse"))
library(ggplot2)
library(grid)
library(gridExtra)
library(plyr)
library(lme4)
library(visreg)
library(reshape)
## clean data and merge with journal metric data
rm(list=ls())
setwd("~/GitHub/open-climate-change/")
setwd('/Users/robins64/Documents/git_repos/open-climate-change')
## load data
load("./Data/scopus_OA_climate_clean.Rdata")  ## scopus data filtered by Jimmy - journals with > 200 papers in last 10 years
load('./Data/scopus_glmerfit.Rdata')
## choose filtered data or full data
dat<-scop
dat$Cited.by[which(is.na(dat$Cited.by))]<-0
jour.dat<-dat[,c("Source.title","X2016.CiteScore","X2016.SJR","X2016.SNIP","Journal.Open.Access")]
jour.dat<-jour.dat[-which(duplicated(jour.dat)),]
## bin for journal rankings
Jour.Var<-"X2016.SJR"     ## Use this
bins<-quantile(jour.dat[,Jour.Var],na.rm=T)  ##quantile bins
## write out journal list with bins
jour.dat$bin<-cut(jour.dat[,Jour.Var],breaks = bins,labels = LETTERS[1:(length(bins)-1)])
jour.dat$bin[which(is.na(jour.dat$bin))]<-"A"
## article journal bins
dat$jour.bin<-cut(dat[,Jour.Var],breaks = bins,labels = LETTERS[1:(length(bins)-1)])
dat$jour.bin[which(is.na(dat$jour.bin))]<-"A"
#############################
####### MODEL FIT TO AGGREGATED BY JOURNAL ########
names(dat)
sub.dat<-dat[,c("Source.title","Year","Cited.by","OA","Open.Access","jour.bin")]
mod.dat<-ddply(sub.dat,.(Source.title,Year,Open.Access,OA,jour.bin),summarize,
MeanCite = mean(Cited.by,na.rm=T))
mod.dat$log10MeanCite<-log10(mod.dat$MeanCite+1)
head(dat)
fit5b<-glmer(Cited.by ~ jour.bin*OA + (1|Year),data=dat,family="poisson")
fit5b<-glmer(log10(Cited.by+1) ~ jour.bin*OA + (1|Year),data=dat,family="poisson")
fit5c<-glmer(MeanCite ~ jour.bin*OA + (1|Year),data=mod.dat,family="poisson")
warnings()
hist(resid(fit5c))
plot(resid(fit5c)~fitted(fit5c))
plot(fitted(fit5c)~mod.dat$MeanCite)
fit5d<-glmer(log10(MeanCite+1) ~ jour.bin*OA + (1|Year),data=mod.dat,family="poisson")
hist(resid(fit5d))
hist(resid(fit5d))
plot(resid(fit5d)~fitted(fit5d))
plot(fitted(fit5d)~log10(mod.dat$MeanCite+1))
fit5e<-glmer(MeanCite ~ jour.bin*OA + (1|Year) + (1|Source.title),data=mod.dat,family="poisson")
hist(resid(fit5d))
plot(resid(fit5d)~fitted(fit5d))
plot(fitted(fit5d)~log10(mod.dat$MeanCite+1))
hist(resid(fit5e))
plot(resid(fit5e)~fitted(fit5e))
plot(fitted(fit5e)~mod.dat$MeanCite)
fit5f<-glmer(log10(MeanCite+1) ~ jour.bin*OA + (1|Year) + (1|Source.title),data=mod.dat,family="poisson")
hist(resid(fit5f))
plot(resid(fit5f)~fitted(fit5f))
plot(fitted(fit5f)~log10(mod.dat$MeanCite+1))
scop.dat<-expand.grid(OA = unique(mod.dat$OA), jour.bin=unique(mod.dat$jour.bin), year = 2008, Journal='Ecology')
scop.dat$p<-predict(fit5f, newdat=scop.dat, re.form=NA, type='response')
scop.dat$OA<-factor(scop.dat$OA,levels=c(TRUE,FALSE))
scop.dat$xdummy<-as.numeric(as.factor(scop.dat$jour.bin)) + ifelse(scop.dat$OA==TRUE,-0.15,+0.15)
pfit1<-ggplot(scop.dat)
pf1<-pfit1 + theme_classic() +
theme(legend.title =  element_blank(),
axis.title.x = element_blank()
) +
ylab("Citations") +
geom_point(aes(x=xdummy,y=p,colour=jour.bin,shape=OA)) +
scale_x_continuous(breaks = seq(1:4),labels=c("Low","Medium","High","Very high"),
expand=c(0,0)) +
coord_cartesian(xlim=c(0.5,4.5)) +
scale_shape_manual(values = c(1,19),labels=c("Open","Closed")) +
scale_colour_discrete(guide=F)
quartz(width=3.5,height=2.5)
pf1
pfit1<-ggplot(scop.dat)
pf1<-pfit1 + theme_classic() +
theme(legend.title =  element_blank(),
axis.title.x = element_blank()
) +
ylab("Citations") +
geom_point(aes(x=xdummy,y=10^p,colour=jour.bin,shape=OA)) +
scale_x_continuous(breaks = seq(1:4),labels=c("Low","Medium","High","Very high"),
expand=c(0,0)) +
coord_cartesian(xlim=c(0.5,4.5)) +
scale_shape_manual(values = c(1,19),labels=c("Open","Closed")) +
scale_colour_discrete(guide=F)
quartz(width=3.5,height=2.5)
pf1
hist(resid(fit5e))
plot(resid(fit5e)~fitted(fit5e))
plot(fitted(fit5e)~mod.dat$MeanCite)
scop.dat<-expand.grid(OA = unique(mod.dat$OA), jour.bin=unique(mod.dat$jour.bin), year = 2008, Journal='Ecology')
scop.dat$p<-predict(fit5e, newdat=scop.dat, re.form=NA, type='response')
scop.dat$OA<-factor(scop.dat$OA,levels=c(TRUE,FALSE))
scop.dat$xdummy<-as.numeric(as.factor(scop.dat$jour.bin)) + ifelse(scop.dat$OA==TRUE,-0.15,+0.15)
pfit1<-ggplot(scop.dat)
pf1<-pfit1 + theme_classic() +
theme(legend.title =  element_blank(),
axis.title.x = element_blank()
) +
ylab("Citations") +
geom_point(aes(x=xdummy,y=p,colour=jour.bin,shape=OA)) +
scale_x_continuous(breaks = seq(1:4),labels=c("Low","Medium","High","Very high"),
expand=c(0,0)) +
coord_cartesian(xlim=c(0.5,4.5)) +
scale_shape_manual(values = c(1,19),labels=c("Open","Closed")) +
scale_colour_discrete(guide=F)
quartz(width=3.5,height=2.5)
pf1
AIC(ft5d)
AIC(fit5d)
AIC(fit5e)
AIC(fit5f)
anova(fit5d,fit5e,fit5f)
AIC(fit5c)
hist(resid(fit5c))
plot(resid(fit5c)~fitted(fit5c))
plot(fitted(fit5c)~mod.dat$MeanCite)
hist(resid(fit5c))
plot(resid(fit5c)~fitted(fit5c))
plot(fitted(fit5c)~mod.dat$MeanCite)
hist(resid(fit5d))
plot(resid(fit5d)~fitted(fit5d))
plot(fitted(fit5d)~log10(mod.dat$MeanCite+1))
hist(resid(fit5e))
plot(resid(fit5e)~fitted(fit5e))
plot(fitted(fit5e)~mod.dat$MeanCite)
hist(resid(fit5f))
plot(resid(fit5f)~fitted(fit5f))
plot(fitted(fit5f)~log10(mod.dat$MeanCite+1))
scop.dat<-expand.grid(OA = unique(mod.dat$OA), jour.bin=unique(mod.dat$jour.bin), year = 2008, Journal='Ecology')
scop.dat$p<-predict(fit5d, newdat=scop.dat, re.form=NA, type='response')
scop.dat$OA<-factor(scop.dat$OA,levels=c(TRUE,FALSE))
scop.dat$xdummy<-as.numeric(as.factor(scop.dat$jour.bin)) + ifelse(scop.dat$OA==TRUE,-0.15,+0.15)
pfit1<-ggplot(scop.dat)
pf1<-pfit1 + theme_classic() +
theme(legend.title =  element_blank(),
axis.title.x = element_blank()
) +
ylab("Citations") +
geom_point(aes(x=xdummy,y=p,colour=jour.bin,shape=OA)) +
scale_x_continuous(breaks = seq(1:4),labels=c("Low","Medium","High","Very high"),
expand=c(0,0)) +
coord_cartesian(xlim=c(0.5,4.5)) +
scale_shape_manual(values = c(1,19),labels=c("Open","Closed")) +
scale_colour_discrete(guide=F)
pf1
scop.dat<-expand.grid(OA = unique(mod.dat$OA), jour.bin=unique(mod.dat$jour.bin), year = 2008, Journal='Ecology')
scop.dat$p<-predict(fit5c, newdat=scop.dat, re.form=NA, type='response')
scop.dat$OA<-factor(scop.dat$OA,levels=c(TRUE,FALSE))
scop.dat$xdummy<-as.numeric(as.factor(scop.dat$jour.bin)) + ifelse(scop.dat$OA==TRUE,-0.15,+0.15)
pfit1<-ggplot(scop.dat)
pf1<-pfit1 + theme_classic() +
theme(legend.title =  element_blank(),
axis.title.x = element_blank()
) +
ylab("Citations") +
geom_point(aes(x=xdummy,y=p,colour=jour.bin,shape=OA)) +
scale_x_continuous(breaks = seq(1:4),labels=c("Low","Medium","High","Very high"),
expand=c(0,0)) +
coord_cartesian(xlim=c(0.5,4.5)) +
scale_shape_manual(values = c(1,19),labels=c("Open","Closed")) +
scale_colour_discrete(guide=F)
pf1
head(dat)
fit5g<-lmer(log10(Cited.by+1) ~ jour.bin*OA + (1|Year) + (1 | Source.title),data=dat)
summary(fit5g)
hist(resid(fit5g))
plot(resid(fit5g)~fitted(fit5g))
plot(fitted(fit5g)~log10(dat$Cited.by+1))
scop.dat<-expand.grid(OA = unique(mod.dat$OA), jour.bin=unique(mod.dat$jour.bin), year = 2008, Journal='Ecology')
scop.dat$p<-predict(fit5g, newdat=scop.dat, re.form=NA, type='response')
scop.dat$OA<-factor(scop.dat$OA,levels=c(TRUE,FALSE))
scop.dat$xdummy<-as.numeric(as.factor(scop.dat$jour.bin)) + ifelse(scop.dat$OA==TRUE,-0.15,+0.15)
pfit1<-ggplot(scop.dat)
pf1<-pfit1 + theme_classic() +
theme(legend.title =  element_blank(),
axis.title.x = element_blank()
) +
ylab("Citations") +
geom_point(aes(x=xdummy,y=p,colour=jour.bin,shape=OA)) +
scale_x_continuous(breaks = seq(1:4),labels=c("Low","Medium","High","Very high"),
expand=c(0,0)) +
coord_cartesian(xlim=c(0.5,4.5)) +
scale_shape_manual(values = c(1,19),labels=c("Open","Closed")) +
scale_colour_discrete(guide=F)
pf1
scop.dat<-expand.grid(OA = unique(mod.dat$OA), jour.bin=unique(mod.dat$jour.bin), year = 2008, Journal='Ecology')
scop.dat$p<-predict(fit5a, newdat=scop.dat, re.form=NA, type='response')
summary(fit5a)
hist(resid(fit5a))
plot(resid(fit5a)~fitted(fit5a))
plot(fitted(fit5a)~mod.dat$log10MeanCite)
scop.dat$p<-predict(fit5a, newdat=scop.dat, re.form=NA, type='response')
scop.dat$OA<-factor(scop.dat$OA,levels=c(TRUE,FALSE))
scop.dat<-expand.grid(OA = unique(mod.dat$OA), jour.bin=unique(mod.dat$jour.bin), year = 2008, Journal='Ecology')
scop.dat$p<-predict(fit5a, newdat=scop.dat, re.form=NA, type='response')
scop.dat$OA<-factor(scop.dat$OA,levels=c(TRUE,FALSE))
scop.dat$xdummy<-as.numeric(as.factor(scop.dat$jour.bin)) + ifelse(scop.dat$OA==TRUE,-0.15,+0.15)
pfit1<-ggplot(scop.dat)
pf1<-pfit1 + theme_classic() +
theme(legend.title =  element_blank(),
axis.title.x = element_blank()
) +
ylab("Citations") +
geom_point(aes(x=xdummy,y=p,colour=jour.bin,shape=OA)) +
scale_x_continuous(breaks = seq(1:4),labels=c("Low","Medium","High","Very high"),
expand=c(0,0)) +
coord_cartesian(xlim=c(0.5,4.5)) +
scale_shape_manual(values = c(1,19),labels=c("Open","Closed")) +
scale_colour_discrete(guide=F)
pf1
pf1<-pfit1 + theme_classic() +
theme(legend.title =  element_blank(),
axis.title.x = element_blank()
) +
ylab("Citations") +
geom_point(aes(x=xdummy,y=10^p,colour=jour.bin,shape=OA)) +
scale_x_continuous(breaks = seq(1:4),labels=c("Low","Medium","High","Very high"),
expand=c(0,0)) +
coord_cartesian(xlim=c(0.5,4.5)) +
scale_shape_manual(values = c(1,19),labels=c("Open","Closed")) +
scale_colour_discrete(guide=F)
pf1
