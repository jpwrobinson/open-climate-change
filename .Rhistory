fit1b<-lmer(Cited.by ~ Open.Access + (1|Year) + (1|Source.title), data=dat)
anova(fit1b)
summary(fit1b)
fit1c<-lmer(Cited.by ~ 1 + (1|Year) + (1|Source.title), data=dat)
anova(fit1c)
summary(fitc)
summary(fit1c)
anova(fit1a,fit1b,fit1c)
summary(fit1a)
fit2<-lmer(Cited.by ~ Open.Access*X2016.SJR + (1|Year) + (1|Source.title), data=dat)
anova(fit2)
AIC(fit2)
j.int<-summary(fit2)$coefficients[2,1]/-summary(fit2)$coefficients[4,1]
anova(fit1a,fit1b,fit1c)
summary(fit1a)
fit3<-lmer(Cited.by ~ Open.Access*X2016.SJR*Year + (1|Source.title), data=dat)
anova(fit3)
summary(fit3)
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin*Year + (1|Source.title), data=dat)
anova(fit1a)
summary(fit1a)
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year) + (1|Source.title), data=dat)
anova(fit1a)
summary(fit1a)
sum.dat2<-ddply(dat,.(Open.Access,jour.bin),summarize,
CiteAve = mean(Cited.by,na.rm=T),
CiteVar = var(Cited.by,na.rm=T),
CiteN = length(Cited.by))
sum.dat2a<-ddply(sum.dat2,.(jour.bin),summarize,
N = sum(CiteN))
sum.dat2a$PropN<-sum.dat2a$N/sum(sum.dat2a$N)
sum.dat2
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin , data=dat)
anova(fit1a)
summary(fit1a)
sum.dat2
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin, data=dat)
fit1a<-lm(Cited.by ~ Open.Access*jour.bin, data=dat)
anova(fit1a)
summary(fit1a)
sum.dat2
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year) + (1|Source.title), data=dat)
anova(fit1a)
summary(fit1a)
fit1a<-lm(Cited.by ~ Open.Access*jour.bin, data=dat)
anova(fit1a)
summary(fit1a)
fit1a$coefficients
str(fit1a$coefficients)
c1<-fit1a$coefficients
c1
c1[1]
c1[1]+c1[2]
summary(fit1a)
c1[1]+c1[3]
c1[1]+c1[2]+c1[3]+c1[6]
c1[1]+c1[4]
c1[1]+c1[2]+c1[4]+c1[7]
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year) + (1|Source.title), data=dat)
anova(fit1a)
summary(fit1a)
coef1<-fit1a$coefficients
coef1<-summary(fit1a)coefficients
coef1<-summary(fit1a)$coefficients
coef1
out.fit1<-data.frame(Open.Access = rep(c("Open access","Closed"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
out.fit1
out.fit1<-data.frame(Open.Access = rep(c("Closed","Open access"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
fit1d<-lmer(Cited.by ~ 0 + Open.Access + jour.bin + Open.Access*jour.bin + (1|Year) + (1|Source.title), data=dat)
anova(fit1d)
summary(fit1d)
summary(fit1a)
out.fit1
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],)
summary(fit1a)
out.fit1<-data.frame(Open.Access = rep(c("Closed","Open access"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],
coef1[1,1] + coef1[2,1] + coef1[4,1] + coef1[7,1],
coef1[1,1] + coef1[2,1] + coef1[5,1] + coef1[8,1],)
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],
coef1[1,1] + coef1[2,1] + coef1[4,1] + coef1[7,1],
coef1[1,1] + coef1[2,1] + coef1[5,1] + coef1[8,1])
View(out.fit1)
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year) , data=dat)
anova(fit1a)
summary(fit1a)
coef1<-summary(fit1a)$coefficients
out.fit1<-data.frame(Open.Access = rep(c("Closed","Open access"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],
coef1[1,1] + coef1[2,1] + coef1[4,1] + coef1[7,1],
coef1[1,1] + coef1[2,1] + coef1[5,1] + coef1[8,1])
fit1b<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year), data=dat)
fit1c<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Source.title), data=dat)
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year) + (1|Source.title), data=dat)
anova(fit1a)
summary(fit1a)
coef1<-summary(fit1a)$coefficients
out.fit1<-data.frame(Open.Access = rep(c("Closed","Open access"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],
coef1[1,1] + coef1[2,1] + coef1[4,1] + coef1[7,1],
coef1[1,1] + coef1[2,1] + coef1[5,1] + coef1[8,1])
fit1b<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year), data=dat)
fit1c<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Source.title), data=dat)
fit1d<-lmer(Cited.by ~ Open.Access + (1|Year) + (1|Source.title), data=dat)
fit1e<-lmer(Cited.by ~ Open.Access + (1|Year), data=dat)
fit1f<-lmer(Cited.by ~ Open.Access + (1|Source.title), data=dat)
fit1g<-lmer(Cited.by ~ 1 + (1|Year) + (1|Source.title), data=dat)
anova(fit1a,fit1b,fit1c,fit1d,fit1e,fit1f,fit1g)
anova(fit1d,fit1e)
,fit1f,fit1g
anova(fit1d,fit1e,fit1f,fit1g)
anova(fit1d,fit1e,fit1c,fit1b)
anova(fit1e,fit1c,fit1b)
anova(fit1d,fit1c,fit1b)
anova(fit1d,fit1b)
anova(fit1a,fit1d)
anova(fit1b,fit1d)
anova(fit1c,fit1d)
anova(fit1a,fit1d,fit1e)
out.fit1<-data.frame(Open.Access = rep(c("Closed","Open access"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],
coef1[1,1] + coef1[2,1] + coef1[4,1] + coef1[7,1],
coef1[1,1] + coef1[2,1] + coef1[5,1] + coef1[8,1])
out.fit1
head(dat)
fit1h<-lm(Cited.by ~ Open.Access*jour.bin, data=dat)
anova(fit1a,fit1d,fit1e,fit1h)
anova(fit1a,fit1b,fit1c,fit1d,fit1e,fit1f,fit1g)
anova(fit1a,fit1d,fit1e)
fit1aa<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Source.title) + (1|Year), data=dat)
anova(fit1a,fit1aa)
summary(fit1aa)
out.fit1
coef1<-summary(fit1aa)$coefficients
out.fit1<-data.frame(Open.Access = rep(c("Closed","Open access"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],
coef1[1,1] + coef1[2,1] + coef1[4,1] + coef1[7,1],
coef1[1,1] + coef1[2,1] + coef1[5,1] + coef1[8,1])
View(out.fit1)
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year) + (1|Source.title), data=dat)
anova(fit1a,fit1a)
summary(fit1a)
coef1<-summary(fit1a)$coefficients
out.fit1<-data.frame(Open.Access = rep(c("Closed","Open access"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],
coef1[1,1] + coef1[2,1] + coef1[4,1] + coef1[7,1],
coef1[1,1] + coef1[2,1] + coef1[5,1] + coef1[8,1])
out.fit1$error<-c(coef1[1,2],
coef1[3,2],
coef1[4,2],
coef1[5,2],
coef1[2,2],
coef1[6,2],
coef1[7,2],
coef1[8,2])
View(out.fit1)
head(out.fit1)
pfit1<-ggplot(out.fit1)
pfit1 + geom_pointrange(aes(x=jour.bin, y=estimate,
ymin=(estimate-error), ymax=(estimate+error),
colour=Open.Access))
pfit1 + geom_violin(aes(x=jour.bin, y=estimate,colour=Open.Access),data=dat)
ggplot(dat) + geom_violin(aes(x=jour.bin, y=Cited.by,colour=Open.Access))
ggplot(dat) + geom_violin(aes(x=jour.bin, y=log(Cited.by),colour=Open.Access))
pfit1 + geom_pointrange(aes(x=jour.bin, y=estimate,
ymin=(estimate-error), ymax=(estimate+error),
colour=Open.Access))
names(fit1a)
names(summary(fit1a))
summary(fit1a)$residuals
pfit1<-ggplot(out.fit1)
pfit1 +
xlab("Citations") + ylab("Journal ranking bin (quantiles)") +
geom_pointrange(aes(x=jour.bin, y=estimate,
ymin=(estimate-error), ymax=(estimate+error),
colour=Open.Access))
pfit1 +
xlab("Journal ranking bin (quantiles)") + ylab("Citations") +
geom_pointrange(aes(x=jour.bin, y=estimate,
ymin=(estimate-error), ymax=(estimate+error),
colour=Open.Access))
Jour.Var<-"X2016.SJR"     ## Use this
bins<-quantile(jour.dat[,Jour.Var],na.rm=T)  ##quantile bins
dat$jour.bin<-cut(dat[,Jour.Var],breaks = bins,labels = LETTERS[1:(length(bins)-1)])
dat$jour.bin[which(is.na(dat$jour.bin))]<-"A"
sum.dat2<-ddply(dat,.(Open.Access,Year,jour.bin),summarize,
CiteAve = mean(Cited.by,na.rm=T),
CiteVar = var(Cited.by,na.rm=T),
CiteN = length(Cited.by))
sum.dat2a<-ddply(sum.dat2,.(jour.bin),summarize,
N = sum(CiteN))
sum.dat2a$PropN<-sum.dat2a$N/sum(sum.dat2a$N)
p1<-ggplot(dat)
quartz(width=8,height = 5)
p1 + theme_classic() +
ggtitle(Jour.Var) +
geom_boxplot(aes(x=as.factor(Year),y=log(Cited.by+1),colour=Open.Access),
outlier.shape=NA) +
facet_wrap(~jour.bin,nrow = 2,ncol = 2, scales="free")
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year) + (1|Source.title), data=dat)
anova(fit1a,fit1a)
summary(fit1a)
coef1<-summary(fit1a)$coefficients
out.fit1<-data.frame(Open.Access = rep(c("Closed","Open access"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],
coef1[1,1] + coef1[2,1] + coef1[4,1] + coef1[7,1],
coef1[1,1] + coef1[2,1] + coef1[5,1] + coef1[8,1])
out.fit1$error<-c(coef1[1,2],
coef1[3,2],
coef1[4,2],
coef1[5,2],
coef1[2,2],
coef1[6,2],
coef1[7,2],
coef1[8,2])
out.fit1
fit1b<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year), data=dat)
fit1c<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Source.title), data=dat)
fit1d<-lmer(Cited.by ~ Open.Access + (1|Year) + (1|Source.title), data=dat)
fit1e<-lmer(Cited.by ~ Open.Access + (1|Year), data=dat)
fit1f<-lmer(Cited.by ~ Open.Access + (1|Source.title), data=dat)
fit1g<-lmer(Cited.by ~ 1 + (1|Year) + (1|Source.title), data=dat)
fit1h<-lm(Cited.by ~ Open.Access*jour.bin, data=dat)
anova(fit1a,fit1b,fit1c,fit1d,fit1e,fit1f,fit1g)
anova(fit1a,fit1d,fit1e)
pfit1<-ggplot(out.fit1)
pfit1 +
xlab("Journal ranking bin (quantiles)") + ylab("Citations") +
geom_pointrange(aes(x=jour.bin, y=estimate,
ymin=(estimate-error), ymax=(estimate+error),
colour=Open.Access))
pfit1<-ggplot(out.fit1)
pf1<-pfit1 +
xlab("Journal ranking bin (quantiles)") + ylab("Citations") +
geom_pointrange(aes(x=jour.bin, y=estimate,
ymin=(estimate-error), ymax=(estimate+error),
colour=Open.Access))
pf1
sum.dat2a
library(ggplot2)
library(grid)
library(gridExtra)
library(plyr)
library(lme4)
library(visreg)
rm(list=ls())
setwd("~/GitHub/open-climate-change/")
setwd('/Users/robins64/Documents/git_repos/open-climate-change')
load("./Data/scopus_OA_climate_clean.Rdata")  ## scopus data filtered by Jimmy - journals with > 300 papers in last 10 years
full.scop<-read.csv("./Data/ScopusOAData_20180214TT.csv",stringsAsFactors = F)
head(scop)
head(full.scop)
dat<-scop
dat$Cited.by[which(is.na(dat$Cited.by))]<-0
nrow(dat[which(dat$Cited.by==0),])
dat<-dat[which(dat$Cited.by>0),]
dat<-scop
summary(dat)
dat$Cited.by[which(is.na(dat$Cited.by))]<-0
jour.dat<-dat[,c("Source.title","X2016.CiteScore","X2016.SJR","X2016.SNIP","Journal.Open.Access")]
jour.dat<-jour.dat[-which(duplicated(jour.dat)),]
sum.dat<-ddply(dat,.(Open.Access,Year),summarize,
CiteAve = mean(Cited.by,na.rm=T),
CiteVar = var(Cited.by,na.rm=T),
CiteN = length(Cited.by))
Jour.Var<-"X2016.SJR"     ## Use this
bins<-quantile(jour.dat[,Jour.Var],na.rm=T)  ##quantile bins
dat$jour.bin<-cut(dat[,Jour.Var],breaks = bins,labels = LETTERS[1:(length(bins)-1)])
dat$jour.bin[which(is.na(dat$jour.bin))]<-"A"
sum.dat2<-ddply(dat,.(Open.Access,Year,jour.bin),summarize,
CiteAve = mean(Cited.by,na.rm=T),
CiteVar = var(Cited.by,na.rm=T),
CiteN = length(Cited.by))
sum.dat2a<-ddply(sum.dat2,.(jour.bin),summarize,
N = sum(CiteN))
sum.dat2a$PropN<-sum.dat2a$N/sum(sum.dat2a$N)
p1<-ggplot(dat)
quartz(width=8,height = 5)
p1 + theme_classic() +
ggtitle(Jour.Var) +
geom_boxplot(aes(x=as.factor(Year),y=log(Cited.by+1),colour=Open.Access),
outlier.shape=NA) +
facet_wrap(~jour.bin,nrow = 2,ncol = 2, scales="free")
p1<-ggplot(dat)
p1 + geom_point(aes(x=Open.Access, y=Cited.by))
p1 + geom_point(aes(x=X2016.SJR, y=Cited.by, colour=Open.Access))
p1 + geom_point(aes(x=log(X2016.SJR), y=log(Cited.by), colour=Open.Access))
p1 + geom_boxplot(aes(x=Year, y=log(Cited.by), colour=Open.Access))
p1 + geom_boxplot(aes(x=as.factor(Year), y=log(Cited.by), colour=Open.Access))
p1 + geom_point(aes(x=log(X2016.SJR), y=log(Cited.by), colour=Open.Access))
p1 + geom_point(aes(x=Open.Access, y=Cited.by))
p1 + geom_boxplot(aes(x=as.factor(Year), y=log(Cited.by), colour=Open.Access),
outlier.shape=NA)
p1 + geom_boxplot(aes(x=as.factor(Year), y=log(Cited.by+1), colour=Open.Access))
p1 + geom_boxplot(aes(x=as.factor(Year), y=log(Cited.by+1), colour=Open.Access),
outlier.shape=NA)
sum.dat<-ddply(dat,.(Open.Access,Year),summarize,
CiteAve = mean(Cited.by,na.rm=T),
CiteVar = var(Cited.by,na.rm=T),
CiteN = length(Cited.by))
Jour.Var<-"X2016.SJR"     ## Use this
bins<-quantile(jour.dat[,Jour.Var],na.rm=T)  ##quantile bins
dat$jour.bin<-cut(dat[,Jour.Var],breaks = bins,labels = LETTERS[1:(length(bins)-1)])
dat$jour.bin[which(is.na(dat$jour.bin))]<-"A"
sum.dat2<-ddply(dat,.(Open.Access,Year,jour.bin),summarize,
CiteAve = mean(Cited.by,na.rm=T),
CiteVar = var(Cited.by,na.rm=T),
CiteN = length(Cited.by))
sum.dat2a<-ddply(sum.dat2,.(jour.bin),summarize,
N = sum(CiteN))
sum.dat2a$PropN<-sum.dat2a$N/sum(sum.dat2a$N)
p1<-ggplot(dat)
quartz(width=8,height = 5)
p1 + theme_classic() +
ggtitle(Jour.Var) +
geom_boxplot(aes(x=as.factor(Year),y=log(Cited.by+1),colour=Open.Access),
outlier.shape=NA) +
facet_wrap(~jour.bin,nrow = 2,ncol = 2, scales="free")
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year), data=dat)
anova(fit1a,fit1a)
summary(fit1a)
coef1<-summary(fit1a)$coefficients
out.fit1<-data.frame(Open.Access = rep(c("Closed","Open access"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],
coef1[1,1] + coef1[2,1] + coef1[4,1] + coef1[7,1],
coef1[1,1] + coef1[2,1] + coef1[5,1] + coef1[8,1])
out.fit1$error<-c(coef1[1,2],
coef1[3,2],
coef1[4,2],
coef1[5,2],
coef1[2,2],
coef1[6,2],
coef1[7,2],
coef1[8,2])
out.fit1
pfit1<-ggplot(out.fit1)
pf1<-pfit1 +
xlab("Journal ranking bin (quantiles)") + ylab("Citations") +
geom_pointrange(aes(x=jour.bin, y=estimate,
ymin=(estimate-error), ymax=(estimate+error),
colour=Open.Access))
pf1
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Source.title), data=dat)
anova(fit1a,fit1a)
summary(fit1a)
coef1<-summary(fit1a)$coefficients
out.fit1<-data.frame(Open.Access = rep(c("Closed","Open access"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],
coef1[1,1] + coef1[2,1] + coef1[4,1] + coef1[7,1],
coef1[1,1] + coef1[2,1] + coef1[5,1] + coef1[8,1])
out.fit1$error<-c(coef1[1,2],
coef1[3,2],
coef1[4,2],
coef1[5,2],
coef1[2,2],
coef1[6,2],
coef1[7,2],
coef1[8,2])
out.fit1
summary(fit1a)
mod.fit<-fit1a  ## choose model to plot
coef1<-summary(mod.fit)$coefficients
out.fit1<-data.frame(Open.Access = rep(c("Closed","Open access"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],
coef1[1,1] + coef1[2,1] + coef1[4,1] + coef1[7,1],
coef1[1,1] + coef1[2,1] + coef1[5,1] + coef1[8,1])
out.fit1$error<-c(coef1[1,2],
coef1[3,2],
coef1[4,2],
coef1[5,2],
coef1[2,2],
coef1[6,2],
coef1[7,2],
coef1[8,2])
out.fit1
pfit1<-ggplot(out.fit1)
pf1<-pfit1 +
xlab("Journal ranking bin (quantiles)") + ylab("Citations") +
geom_pointrange(aes(x=jour.bin, y=estimate,
ymin=(estimate-error), ymax=(estimate+error),
colour=Open.Access))
pf1
fit1i<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year) + (jour.bin|Source.title), data=dat)
mod.fit<-fit1i  ## choose model to plot
summary(mod.fit)
fit1i<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year) + (Source.title|jour.bin), data=dat)
Source.title
fit1i<-lmer(Cited.by ~ Open.Access*jour.bin + (1|Year) + (jour.bin|Source.title), data=dat)
summary(fit1i)
mod.fit<-fit1i  ## choose model to plot
summary(mod.fit)
coef1<-summary(mod.fit)$coefficients
out.fit1<-data.frame(Open.Access = rep(c("Closed","Open access"),each=4),
jour.bin = rep(c(LETTERS[1:4]),times=2))
out.fit1$estimate<-c(coef1[1,1],
coef1[1,1] + coef1[3,1],
coef1[1,1] + coef1[4,1],
coef1[1,1] + coef1[5,1],
coef1[1,1] + coef1[2,1],
coef1[1,1] + coef1[2,1] + coef1[3,1] + coef1[6,1],
coef1[1,1] + coef1[2,1] + coef1[4,1] + coef1[7,1],
coef1[1,1] + coef1[2,1] + coef1[5,1] + coef1[8,1])
out.fit1$error<-c(coef1[1,2],
coef1[3,2],
coef1[4,2],
coef1[5,2],
coef1[2,2],
coef1[6,2],
coef1[7,2],
coef1[8,2])
out.fit1
pfit1<-ggplot(out.fit1)
pf1<-pfit1 +
xlab("Journal ranking bin (quantiles)") + ylab("Citations") +
geom_pointrange(aes(x=jour.bin, y=estimate,
ymin=(estimate-error), ymax=(estimate+error),
colour=Open.Access))
pf1
fit2<-lmer(Cited.by ~ Open.Access*X2016.SJR + (1|Year) + (1|Source.title), data=dat)
anova(fit2)
summary(fit2)
AIC(fit2)
fit3<-lmer(Cited.by ~ Open.Access*X2016.SJR*Year + (1|Source.title), data=dat)
anova(fit3)
summary(fit3)
AIC(fit3)
anova(fit2,fit3,fit1a)
fit3<-lmer(Cited.by ~ Open.Access*X2016.SJR*as.factor(Year) + (1|Source.title), data=dat)
anova(fit3)
summary(fit3)
AIC(fit3)
anova(fit2,fit3,fit1a)
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin + (1|as.factor(Year)) + (1|Source.title), data=dat)
fit1a<-lmer(Cited.by ~ Open.Access*jour.bin + (1|(as.factor(Year))) + (1|Source.title), data=dat)
anova(fit2,fit3,fit1a)
anova(fit2,fit1a)
anova(fit2,fit3,fit1a)
summary(fit3)
fit3<-lmer(Cited.by ~ Open.Access*X2016.SJR*Year + (1|Source.title), data=dat)
summary(fit3)
